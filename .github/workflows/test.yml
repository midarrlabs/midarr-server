name: Test

on:
  push:
    branches:
      - '**'

jobs:

  test:
    name: OTP ${{matrix.otp}} / Elixir ${{matrix.elixir}}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        otp: [ '24' ]
        elixir: [ '1.13.4' ]
    steps:
      - uses: actions/checkout@v2
      - run: groupadd media
      - run: chmod u+x script-install-radarr.sh
      - run: ./script-install-radarr.sh
      - run: curl --head -X GET --retry 5 --retry-connrefused --retry-delay 5 http://localhost:7878
      - run: chmod u+x script-install-sonarr.sh
      - run: ./script-install-sonarr.sh
      - run: curl --head -X GET --retry 5 --retry-connrefused --retry-delay 5 http://localhost:8989